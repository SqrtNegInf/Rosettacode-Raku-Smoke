#!/usr/bin/env raku
#u# http://rosettacode.org/wiki/Generate_random_numbers_without_repeating_a_value
#c# 2021-08-28 <RC
#m# MOAR: OK
#j# JVM:  BROKEN
#s# --optimize=0
#n# illustrate use of enhanced 'pick' (and illustrate another 'srand' fragility...)
#n# 2023-02-25 answer doesn't change despite '#s#' switch,  terminal/cron results still differ

use v6.e.PREVIEW; 

srand 123456;

my @res.push: $_ for (1..20).pick(**).[^100].batch(20);

.put for @res;

my $moar-terminal = q:to/END/;
5 11 10 13 9 20 12 8 6 1 2 19 15 16 17 7 14 3 18 4
19 18 14 3 15 11 13 9 2 4 10 16 17 12 6 20 5 8 7 1
12 5 8 19 14 18 4 7 3 16 2 9 10 15 11 1 17 6 20 13
17 7 10 15 11 16 13 14 6 20 8 18 4 2 1 12 19 5 3 9
1 18 10 4 19 15 12 9 3 13 16 20 7 5 2 8 14 17 6 11
END

my $moar-cronjob = q:to/END/;
15 9 16 5 8 4 20 2 7 12 18 3 6 10 1 17 11 14 13 19
1 19 14 5 4 12 10 2 20 7 17 13 9 8 3 15 6 16 11 18
20 14 1 6 15 18 3 17 8 5 11 2 19 7 4 10 16 13 12 9
16 13 4 10 9 11 8 5 17 7 19 1 2 20 18 15 3 12 6 14
20 14 17 16 13 3 18 9 11 8 2 15 12 19 10 6 4 5 7 1
END

if qx/uname -a/ ~~ /'iMac'/ {
$moar-cronjob = q:to/END/;
18 5 9 4 17 2 8 14 10 16 13 12 1 7 20 6 11 3 19 15
15 5 4 13 12 2 20 8 6 14 11 3 9 1 18 19 16 10 17 7
1 7 17 20 4 19 9 6 13 3 16 14 5 15 18 2 12 11 8 10
5 11 10 13 9 20 12 8 6 1 2 19 15 16 17 7 14 3 18 4
19 18 14 3 15 11 13 9 2 4 10 16 17 12 6 20 5 8 7 1
END
}

my $linux = q:to/END/;
16 11 13 19 9 12 10 6 17 3 5 2 20 1 4 15 18 7 8 14
2 17 20 1 14 12 19 13 9 3 11 7 6 16 15 10 18 8 5 4
8 2 12 15 14 10 16 17 1 4 13 18 19 11 7 3 20 9 5 6
12 19 2 6 4 13 11 9 3 7 17 14 5 20 8 15 18 1 10 16
11 1 14 19 4 15 18 10 20 13 8 2 12 5 6 16 17 7 9 3
END

use Test;
is @res.join("\n"), chomp $*KERNEL eq 'linux' ??  $linux !!  $*IN.t ?? $moar-terminal !! $moar-cronjob;
#is @res.join("\n"), chomp $*IN.t ?? $moar-terminal !! $*KERNEL eq 'linux' ?? $linux-cronjob !! $moar-cronjob;
