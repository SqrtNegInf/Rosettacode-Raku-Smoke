#!/usr/bin/env perl6
#u# http://rosettacode.org/wiki/Knuth's_algorithm_S
#c# 2016-01-05 <RC,  2022-08-21 >RC
#m# MOAR: OK
#j#  JVM: OK
#n# this version on RC; using 'srand', so will periodically have to update results  

srand 123456;

sub s_of_n_creator($n) {
    my (@sample, $i);
    -> $item {
        if    ++$i      <= $n { @sample.push:      $item } # .append gives different result?
        elsif   $i.rand <  $n { @sample[$n.rand] = $item }
        @sample
    }
}

my @bin;

for ^100000 {
    my &s_of_n = s_of_n_creator 3;
    sink .&s_of_n for ^9;
    @bin[$_]++ for s_of_n 9;
}

say my $result = @bin.join: ' ';

my $moar-terminal-mac-pro = '29762 29796 30111 30244 29897 29908 29867 29885 30379 30151';
my $moar-cronjob-mac-pro  = '29763 29793 30107 30243 29897 29908 29866 29884 30384 30155';
my $moar-terminal-imac    = '29763 29792 30107 30243 29898 29909 29864 29885 30384 30155';
my $moar-cronjob-imac     = '29763 29795 30108 30241 29899 29909 29862 29886 30384 30153';
my $jvm                   = '30155 30207 30016 30169 30044 29973 29725 29932 30041 29738';

use Test;

if qx/uname -a/ ~~ /'Mac-Pro'/ {
    is $result, chomp $*VM ~~ /jvm/ ?? $jvm !! $*IN.t ?? $moar-terminal-mac-pro !! $moar-cronjob-mac-pro;
} else {
    is $result, chomp $*VM ~~ /jvm/ ?? $jvm !! $*IN.t ?? $moar-terminal-imac    !! $moar-cronjob-imac;
}
