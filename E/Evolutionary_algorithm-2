#!/usr/bin/env perl6
#u# http://rosettacode.org/wiki/Evolutionary_algorithm
#c# 2022-10-21 <RC
#m# MOAR: OK
#j#  JVM: OK
#n# takes over 11K interations

srand 123456;

constant target = "METHINKS IT IS LIKE A WEASEL";
constant @alphabet = flat 'A'..'Z',' ';
constant C = 10;

sub mutate(Str $string, Real $mutate-chance where 0 â‰¤ * < 1) {
  $string.subst: /<?{ rand < $mutate-chance }> . /, @alphabet.pick, :global
}
sub fitness(Str $string) { [+] $string.comb Zeq target.comb }

#printf "\r%6d: '%s'", $++, $_ for
my $iter;
$iter++ for
  @alphabet.roll(target.chars).join,
  { max :by(&fitness), mutate($_, .001) xx C } ... target;

use Test;
say 'Iterations: ' ~ $iter;
is $iter, $*VM ~~ /jvm/ ?? 14560 !! $*IN.t ?? 11047 !! 6843;
#ok ($iter == 11047 or $iter == 6843);
